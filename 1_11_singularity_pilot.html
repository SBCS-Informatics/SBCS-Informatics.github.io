<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Singularity Pilot | SBCS-Informatics</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.1">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="./1_12_handy_shortcuts.html" />
    
    
    <link rel="prev" href="./1_10_galaxy.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-edit-link/plugin.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-anchors/plugin.css">
        
    
    

        
    <div class="book" data-level="1.11" data-basepath="." data-revision="Thu Feb 09 2017 16:42:40 GMT+0000 (UTC)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="1_0_using_unix_and_apocrita.html">
            
                
                    <a href="./1_0_using_unix_and_apocrita.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Using Unix and Apocrita
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="1_1_what_is_apocrita.html">
            
                
                    <a href="./1_1_what_is_apocrita.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        What is Apocrita?
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="1_2_connecting_to_apocrita.html">
            
                
                    <a href="./1_2_connecting_to_apocrita.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Connecting to Apocrita
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="1_3_launching_a_job_on_apocrita.html">
            
                
                    <a href="./1_3_launching_a_job_on_apocrita.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Launching a Job on Apocrita
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="1_4_basic_unix_navigation.html">
            
                
                    <a href="./1_4_basic_unix_navigation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        Basic UNIX Navigation
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="1_5_playing_with_files.html">
            
                
                    <a href="./1_5_playing_with_files.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                        Playing With Files
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="1_6_copying_and_downloading_files.html">
            
                
                    <a href="./1_6_copying_and_downloading_files.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.6.</b>
                        
                        Copying &amp; Downloading Files
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="1_7_dealing_with_compressed_files.html">
            
                
                    <a href="./1_7_dealing_with_compressed_files.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.7.</b>
                        
                        Dealing with Compressed Files
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="1_8_compiling_a_piece_of_software.html">
            
                
                    <a href="./1_8_compiling_a_piece_of_software.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.8.</b>
                        
                        Available Software
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="1_9_r.html">
            
                
                    <a href="./1_9_r.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.9.</b>
                        
                        R
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="1_10_galaxy.html">
            
                
                    <a href="./1_10_galaxy.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.10.</b>
                        
                        Galaxy
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="1.11" data-path="1_11_singularity_pilot.html">
            
                
                    <a href="./1_11_singularity_pilot.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.11.</b>
                        
                        Singularity Pilot
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="1_12_handy_shortcuts.html">
            
                
                    <a href="./1_12_handy_shortcuts.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.12.</b>
                        
                        Handy Shortcuts
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="2_0_advanced.html">
            
                
                    <a href="./2_0_advanced.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Advanced
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="3_0_contact.html">
            
                
                    <a href="./3_0_contact.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Contact
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    

    
    
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >SBCS-Informatics</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <a id="edit-link" href="https://github.com/sbcs-informatics/sbcs-informatics.github.io/edit/src/1_11_singularity_pilot.md" class="btn fa fa-edit pull-left">&#xA0;&#xA0;Edit</a><h2 id="11-singularity-pilot"><a name="11-singularity-pilot" class="plugin-anchor" href="#11-singularity-pilot"><span class="fa fa-link"></span></a>11. Singularity Pilot</h2>
<p>ITS Research have installed <a href="singularity.lbl.gov">Singularity</a> for us to test in SBCS. Singularity is a containerisation platform which enables full control of the environment in which a program runs, without having to rely on libraries and software installed on the Apocrita filesystem. </p>
<h1 id="if-you-want-to-try-singularity-during-the-pilot-phase-please-contact-adrian-3-0-contact-md"><a name="if-you-want-to-try-singularity-during-the-pilot-phase-please-contact-adrian-3-0-contact-md" class="plugin-anchor" href="#if-you-want-to-try-singularity-during-the-pilot-phase-please-contact-adrian-3-0-contact-md"><span class="fa fa-link"></span></a>IF YOU WANT TO TRY SINGULARITY DURING THE PILOT PHASE PLEASE <a href="3_0_contact.html">CONTACT ADRIAN</a></h1>
<h3 id="containers"><a name="containers" class="plugin-anchor" href="#containers"><span class="fa fa-link"></span></a>Containers</h3>
<p>There are many flavours of containers and each has benefits and downsides. Docker is the most ubiquitous and the platform with the most features. However, there are some serious security flaws which prevents us from using Docker on the HPC. Singularity does however support a very simple import of Docker containers from the repository <a href="hub.docker.com">Docker Hub</a>.</p>
<h3 id="quick-start-import-a-docker-container-from-docker-hub-hub-docker-com"><a name="quick-start-import-a-docker-container-from-docker-hub-hub-docker-com" class="plugin-anchor" href="#quick-start-import-a-docker-container-from-docker-hub-hub-docker-com"><span class="fa fa-link"></span></a>Quick-start import a Docker container from <a href="hub.docker.com">Docker Hub</a></h3>
<p>If you have ever found a docker container you might want to use on Apocrita, the following will explain how to make it run on the cluster through Singularity. You do not need a Docker Hub user account but you do need to know the Docker Hub user and container names.</p>
<p>The only thing you need is access to a machine with Singularity installed where you have administrator permissions. This can be a Virtual Machine (VM) with Linux and Singularity installed in it or your local Linux machine if you have one. If you are unsure about what this means or how to create a VM like that, <a href="3_0_contact.html">please get in contact</a>.</p>
<h4 id="1-create-a-definition-file"><a name="1-create-a-definition-file" class="plugin-anchor" href="#1-create-a-definition-file"><span class="fa fa-link"></span></a>1. Create a definition file</h4>
<p>Create a new text file and enter the following. Exchange the name of the Docker container from Docker Hub in the second line after <code>From:</code> to your preferred container. Leave everything else as it is. The Docker Hub user in this example is bioconductor and the container name is release_sequencing. The identifier for this container is thus <code>bioconductor/release_sequencing</code>. </p>
<p><code>my_definition_file.def</code>:</p>
<pre><code class="lang-bash">Bootstrap: docker
From: bioconductor/release_sequencing
IncludeCmd: yes

%post
        mkdir /data
</code></pre>
<h4 id="2-build-the-image"><a name="2-build-the-image" class="plugin-anchor" href="#2-build-the-image"><span class="fa fa-link"></span></a>2. Build the image</h4>
<p>To create the image and import the docker container run the following commands. Depending on the size of the Docker container, you may have to increase the size of your image. This is the step which requires administrative permissions on a Linux machine. </p>
<pre><code class="lang-bash">sudo singularity create --size <span class="hljs-number">1024</span> image_name.img       
<span class="hljs-comment"># Create empty image of size 1024MB</span>

sudo singularity bootstrap image_name.img my_definition_file.def
<span class="hljs-comment"># Run bootstrap on that image</span>
</code></pre>
<h4 id="3-copy-the-image-to-apocrita-and-run"><a name="3-copy-the-image-to-apocrita-and-run" class="plugin-anchor" href="#3-copy-the-image-to-apocrita-and-run"><span class="fa fa-link"></span></a>3. Copy the image to Apocrita and run!</h4>
<p>The image is ready to be transferred to Apocrita for execution on the cluster. </p>
<pre><code class="lang-bash">scp image_name.img btw000@login.hpc.qmul.ac.uk:~/
<span class="hljs-comment"># Using scp to copy the image to your home directory on Apocrita</span>
</code></pre>
<p>Once the image is on the Apocrita file system, create your submission script and add the following to run your newly created container. </p>
<p>You can test your container in a qlogin session</p>
<pre><code class="lang-bash">qlogin
module load singularity
singularity <span class="hljs-built_in">exec</span> image_name.img <span class="hljs-built_in">command</span>_name argument1 argument2

<span class="hljs-comment">#singularity exec image_name.img    &lt;- This is a Singularity call</span>
<span class="hljs-comment">#command_name argument1 argument2   &lt;- This is your call to the software</span>
</code></pre>
<h3 id="creating-a-custom-definition-file"><a name="creating-a-custom-definition-file" class="plugin-anchor" href="#creating-a-custom-definition-file"><span class="fa fa-link"></span></a>Creating a custom definition file</h3>
<p>Unlike Docker, Singularity does not have a daemon running as root to control the containers running on the system. Everything is running as your user. However, in the steps that build the image file you need sudo access. For this reason, those steps cannot be completed on the Apocrita file system and must be carried out on another machine. This could for example be your desktop computer if you have a linux machie, a Virtual Machine you have set up yourself, or the vagrant VM that ITSR provides. After you are done creating the image you can copy it to Apocrita and run it. </p>
<p>There are three fundamental steps to creating and running a container with Singularity.</p>
<ol>
<li>Writing a bootstrap definition file</li>
<li>Creating the empty image and running the bootstrap (ie installing the things described in the definition file inside the image file)</li>
<li>Running the container</li>
</ol>
<h4 id="definition-file"><a name="definition-file" class="plugin-anchor" href="#definition-file"><span class="fa fa-link"></span></a>Definition file</h4>
<p>This is a description file which tells singularity what to put inside the image. There are a few ways of doing it, but the most fundamental way is to have it download a version of ubuntu or centos, then install your tools/libraries through yum/apt-get/git etc. You can also import Docker images in the bootstrap step. </p>
<p>Here is an example of a fairly simple .def file (This particular one installs bowtie2-2.3.0 from sourceforge):</p>
<p>The first three lines describe how to start the bootstrap procedure, here we choose Ubuntu Xenial and point to where it can be downloaded. Everything in the %post block runs once when the image is bootstrapped. A %test section is included as well to make sure everything worked out. There are other sections you can include here too, see the <a href="http://singularity.lbl.gov/bootstrap-image" target="_blank">Singularity documentation</a>.</p>
<pre><code class="lang-bash">Bootstrap: debootstrap
OSversion: xenial
MirrorURL: http://archive.ubuntu.com/ubuntu/

<span class="hljs-comment"># Requires 1024MB image size</span>

%post 
    <span class="hljs-comment"># Create the /data directory</span>
    mkdir /data

    apt-get update

    <span class="hljs-comment"># This is needed to be able to add the universe repo</span>
    <span class="hljs-comment"># which is needed for apt to find libtbb-dev</span>

    apt-get install -y software-properties-common     
    add-apt-repository universe                                                                         

    <span class="hljs-comment"># Running normal apt-get update and isntalling the tools needed</span>
    apt-get update
    apt-get install -y vim wget unzip build-essential libtbb-dev

    <span class="hljs-comment"># Downloading from sourceforge and installing</span>
    wget https://sourceforge.net/projects/bowtie-bio/files/bowtie2/<span class="hljs-number">2.3</span>.<span class="hljs-number">0</span>/bowtie2-<span class="hljs-number">2.3</span>.<span class="hljs-number">0</span>-source.zip

    unzip bowtie2-<span class="hljs-number">2.3</span>.<span class="hljs-number">0</span>-source.zip
    <span class="hljs-built_in">cd</span> bowtie2-<span class="hljs-number">2.3</span>.<span class="hljs-number">0</span>/
    make
    make install

%<span class="hljs-built_in">test</span>
    bowtie2 -h
</code></pre>
<h4 id="bootstrap"><a name="bootstrap" class="plugin-anchor" href="#bootstrap"><span class="fa fa-link"></span></a>Bootstrap</h4>
<p>To create an image which contains the things you detailed in the definition file, you need to first create an empty image and then run the bootstrap. These two steps are the only ones that require sudo access. The default image size is 768MB, which is enough for many lightweight toolchains, but you can decide the image size yourself. Unfortunately it cannot be automatically grown by the bootstrap command, so if it runs out of space it will just crash. If this happens, delete the image and create a new one with larger size and try again. Sometimes its hard to tell what size you will need, I have created images varying in size from 768MB to 10GB. </p>
<pre><code class="lang-bash">sudo singularity create --size <span class="hljs-number">1024</span> image_name.img       
<span class="hljs-comment"># Create empty image of size 1024MB</span>

sudo singularity bootstrap image_name.img definition_file.def
<span class="hljs-comment"># Run bootstrap on that image</span>
</code></pre>
<h4 id="execution"><a name="execution" class="plugin-anchor" href="#execution"><span class="fa fa-link"></span></a>Execution</h4>
<p>This is the step in which you will run the container and the tools you have packaged within. This step does not require sudo access, but it does take settings from a global configuration file which ITSR has control over. The image is immutable once created so you will not be able to install any more tools or anything like that, you also cannot change/store data in the image once its been created. All of that will have to happen in the bootstrap step, so if you want to change the version of the tool installed, you need to create a new image and bootstrap it with a different definition file. </p>
<pre><code class="lang-bash">singularity <span class="hljs-built_in">exec</span> image_name.img <span class="hljs-built_in">command</span> [arguments ...]

<span class="hljs-comment"># For example, to print bowtie2 help</span>
singularity <span class="hljs-built_in">exec</span> ubuntu-bowtie2-<span class="hljs-number">2.3</span>.<span class="hljs-number">0</span>.img bowtie2 -h
</code></pre>
<p>You can also shell into the container, either by using the singularity shell command or by exec invoking bash/sh:</p>
<pre><code class="lang-bash">singularity shell image_name.img

singularity <span class="hljs-built_in">exec</span> image_name.img bash
</code></pre>
<h4 id="singularity-on-apocrita"><a name="singularity-on-apocrita" class="plugin-anchor" href="#singularity-on-apocrita"><span class="fa fa-link"></span></a>Singularity on Apocrita</h4>
<p>Singularity is installed on Apocrita and ITSR have allowed access to those willing to try it out. However, because singularity needs sudo access to create the empty image and for the bootstrap step, those two steps need to be completed outside Apocrita. Execution of a container does not require sudo access and thus it is possible to create the image on your own machine, copy it over to Apocrita and then run your packaged tool through singularity as your Apocrita user. </p>
<h5 id="-data-mount"><a name="-data-mount" class="plugin-anchor" href="#-data-mount"><span class="fa fa-link"></span></a>/data mount</h5>
<p>In order to have access to your data on Apocrita, you need to create the /data directory in your image during the bootstrap step. After doing that, Singularity will be able to mount all your data directories automatically when you run the container. If you do not have the /data directory made in your bootstrap step the container will not have any access to your data files on Apocrita. </p>
<p>You do this in the %post section of your bootstrap definition file. It does not matter where, but I usually put it in the beginning to remember.</p>
<h5 id="mpi"><a name="mpi" class="plugin-anchor" href="#mpi"><span class="fa fa-link"></span></a>MPI</h5>
<p>Singularity does support MPI over the cluster scheduler out of the box. In order to get it running there are a couple of things you need to do though. </p>
<h6 id="building-the-image"><a name="building-the-image" class="plugin-anchor" href="#building-the-image"><span class="fa fa-link"></span></a>Building the image</h6>
<p>In order to take advantage of MPI on the cluster a version of MPI must be installed in the singularity image, as well as a way for the MPI jobs to communicate. </p>
<ul>
<li>The MPI version must be the same as the one you load on Apocrita<ul>
<li>Loading the module openmpi/1.6.5 on Apocrita means you need to install Open MPI 1.6.5 in the bootstrap step of your image</li>
</ul>
</li>
<li>Installing openssh-server (using either yum or apt-get depending on your flavour) in the bootstrap step should enough to handle communications</li>
</ul>
<h6 id="executing-the-image-on-the-queue"><a name="executing-the-image-on-the-queue" class="plugin-anchor" href="#executing-the-image-on-the-queue"><span class="fa fa-link"></span></a>Executing the image on the queue</h6>
<p>Requesting an MPI environment on the cluster can be done in several ways. The new hardware provision will provide a large number of compute cores with high performance interconnect, which is perfect for MPI. It is still not clear whether these machines will be on a separate queue or if everything will be handled by the scheduler internally. </p>
<p>This is an example of a submission script which utilises MPI on the old provision. The number of parallel slots must match the -np argument supplied to mpirun!</p>
<pre><code class="lang-bash"><span class="hljs-shebang">#!/bin/sh</span>
<span class="hljs-comment">#$ -cwd              # Set the working directory for the job to the current directory</span>
<span class="hljs-comment">#$ -V                # </span>
<span class="hljs-comment">#$ -pe parallel 4    # Request 4 parallel slots</span>
<span class="hljs-comment">#$ -l h_rt=1:0:0     # Request 1 hour runtime</span>
<span class="hljs-comment">#$ -l h_vmem=1G      # Request 1GB RAM per core</span>

module load use.dev
module load singularity
module load openmpi/<span class="hljs-number">1.6</span>.<span class="hljs-number">5</span>/gcc/<span class="hljs-number">4.7</span>.<span class="hljs-number">2</span> <span class="hljs-comment"># OpenMPI 1.6.5 is installed in the image</span>

mpirun -np <span class="hljs-number">4</span> singularity <span class="hljs-built_in">exec</span> ./ubuntu-mrbayes-<span class="hljs-number">3.2</span>.<span class="hljs-number">6</span>.img mb ./examples/hymfossil.nex

<span class="hljs-comment"># The image is called ubuntu-mrbayes-3.2.6.img</span>
<span class="hljs-comment"># and the command running within the container is mb ./examples/hymfossil.nex</span>
</code></pre>
<h5 id="issues"><a name="issues" class="plugin-anchor" href="#issues"><span class="fa fa-link"></span></a>Issues</h5>
<p>Singularity is running with surprising smoothness, but not everything worked right away. </p>
<h6 id="mpi-solved"><a name="mpi-solved" class="plugin-anchor" href="#mpi-solved"><span class="fa fa-link"></span></a>MPI - SOLVED</h6>
<p>Had to install correct version of OpenMPI and install openssh-server to get it working. More details in the MPI section above. </p>
<h6 id="image-size-workaround"><a name="image-size-workaround" class="plugin-anchor" href="#image-size-workaround"><span class="fa fa-link"></span></a>Image size - WORKAROUND</h6>
<p>Singularity does not automatically create an image of the correct size for your container, you need to specify the image size in the create step and if its too small the bootstrap step will fail. On the other hand you do not want to specify a huge image size because you will need to copy the image around afterwards!</p>
<p>There is a command to grow the image size - unfortunately I have found that once your bootstrap step has failed once, it will not work to run the bootstrap again on the same image. This is a minimal annoyance as you can just delete the image and create a new one with larger size, which is what I have been doing when I run into space issues in the bootstrap step.</p>
<p>I have tried to get into the habit of adding image size specifications in the .def file so that a future user will know what image size is needed to successfully complete the bootstrap step. </p>
<h6 id="-data-mount-solved"><a name="-data-mount-solved" class="plugin-anchor" href="#-data-mount-solved"><span class="fa fa-link"></span></a>/data mount - SOLVED</h6>
<p>Singularity will automatically mount your home directory, but it did not automatically mount the rest of /data, which is where almost all users have their data spread out. ITSR changed the config file for Singularity to automatically mount all of /data instead of just /data/home/username, that way all data that users have access to should be available in the container. Very simple and quick fix.</p>
<h6 id="debootstrap-not-installed-solved"><a name="debootstrap-not-installed-solved" class="plugin-anchor" href="#debootstrap-not-installed-solved"><span class="fa fa-link"></span></a>debootstrap not installed - SOLVED</h6>
<p>This was a minor issue, but the host you are creating your images on has to have the tool debootstrap installed if you are going to base your images on ubuntu. This has to be installed with yum on a centos machine and may have to be installed even on ubuntu machines. <code>sudo yum install debootstrap</code> should do the trick. You might have to install yum on ubuntu to create centos images? (Not tested)</p>
<h6 id="-def-file-too-large-workaround"><a name="-def-file-too-large-workaround" class="plugin-anchor" href="#-def-file-too-large-workaround"><span class="fa fa-link"></span></a>.def file too large - WORKAROUND</h6>
<p>Found that one of my def files was too large, singularity complains in the bootstrap step if there is too many characters in the %post section. I recompiled Singularity on the machine where I build the images after editing some of the C code. It did work but I had to run the binary from the src directory, running <code>sudo make install</code> did not change anything...! More info on this <a href="https://github.com/singularityware/singularity/issues/456" target="_blank">github issue</a>.</p>
<p><img src="img/qmul_logo.png" alt="QMUL logo"></p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./1_10_galaxy.html" class="navigation navigation-prev " aria-label="Previous page: Galaxy"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./1_12_handy_shortcuts.html" class="navigation navigation-next " aria-label="Next page: Handy Shortcuts"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-edit-link/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"edit-link":{"base":"https://github.com/sbcs-informatics/sbcs-informatics.github.io/edit/src","label":"Edit"},"ga":{"token":"UA-69175221-1","configuration":"auto"},"search-pro":{"cutWordLib":"nodejieba","defineWord":["小需求","基础建设"]}};
    gitbook.start(config);
});
</script>

        <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-69175221-1', 'auto');ga('send', 'pageview');</script>
    </body>
    
</html>
